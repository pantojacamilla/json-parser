    function resizeImage(input, maxWidth, maxHeight, callback) {&#xD;&#xA;      var data;&#xD;&#xA;        if (input.files && input.files[0]) {&#xD;&#xA;          var reader = new FileReader();&#xD;&#xA;          reader.onload = function (event) {&#xD;&#xA;            var img = new Image();&#xD;&#xA;            img.onload = function () {&#xD;&#xA;              var oc = document.createElement('canvas'), octx = oc.getContext('2d');&#xD;&#xA;              oc.width = img.width;&#xD;&#xA;              oc.height = img.height;&#xD;&#xA;              octx.drawImage(img, 0, 0);&#xD;&#xA;              oc.width = maxWidth;&#xD;&#xA;              oc.height = maxHeight;&#xD;&#xA;              if (img.width > maxWidth) {&#xD;&#xA;                octx.drawImage(oc, 0, 0, oc.width, oc.height);&#xD;&#xA;                octx.drawImage(img, 0, 0, oc.width, oc.height);&#xD;&#xA;                data = oc.toDataURL("image/jpeg", 0.7);&#xD;&#xA;              } else {&#xD;&#xA;                data = oc.toDataURL("image/jpeg", 0.7);&#xD;&#xA;              }&#xD;&#xA;              callback(data);&#xD;&#xA;            };&#xD;&#xA;            img.src = event.target.result;&#xD;&#xA;          };&#xD;&#xA;          reader.readAsDataURL(input.files[0]);&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;    function run() {&#xD;&#xA;        resizeImage(&#xD;&#xA;          document.getElementById('image'), &#xD;&#xA;          600, 600, &#xD;&#xA;          function(dat) { &#xD;&#xA;      		document.getElementById('preview').src= dat; &#xD;&#xA;          }&#xD;&#xA;        )&#xD;&#xA;    }