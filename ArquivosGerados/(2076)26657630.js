    $sescam_ventana = {&#xD;&#xA;      init: function() {&#xD;&#xA;        this.mapa();&#xD;&#xA;      },&#xD;&#xA;      mapa: function() {&#xD;&#xA;        var script = document.createElement('script');&#xD;&#xA;        script.type = 'text/javascript';&#xD;&#xA;        script.src = '//maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&callback=$sescam_ventana.mapSetup';&#xD;&#xA;        document.body.appendChild(script);&#xD;&#xA;      },&#xD;&#xA;      mapSetup: function() {&#xD;&#xA;        var styles = [&#xD;&#xA;          /*&#xD;&#xA;    			{&#xD;&#xA;    				stylers: [&#xD;&#xA;    					{ saturation: -100 }&#xD;&#xA;    				]&#xD;&#xA;    			},{&#xD;&#xA;    				featureType: "road",&#xD;&#xA;    				elementType: "geometry",&#xD;&#xA;    				stylers: [&#xD;&#xA;    					{ visibility: "simplified" }&#xD;&#xA;    				]&#xD;&#xA;    			},{&#xD;&#xA;    				featureType: "poi.business",&#xD;&#xA;    				elementType: "labels",&#xD;&#xA;    				stylers: [&#xD;&#xA;    					{ visibility: "simplified" }&#xD;&#xA;    				]&#xD;&#xA;    			}&#xD;&#xA;    		*/&#xD;&#xA;        ];&#xD;&#xA;        var styledMap = new google.maps.StyledMapType(styles, {&#xD;&#xA;          name: "SESCAM"&#xD;&#xA;        }); //&#xD;&#xA;        var mapOptions = {&#xD;&#xA;          zoom: 16,&#xD;&#xA;          scrollwheel: false,&#xD;&#xA;          center: new google.maps.LatLng(39.6177074, 4.9725879),&#xD;&#xA;          mapTypeControlOptions: {&#xD;&#xA;            mapTypeIds: [google.maps.MapTypeId.ROADMAP, 'map_style']&#xD;&#xA;          }&#xD;&#xA;        }&#xD;&#xA;        var handleMarkerClick = function(marker, index) {&#xD;&#xA;          var $navigationMenu = jQuery('<div>');&#xD;&#xA;          jQuery('.menu-item').each(function(i) {&#xD;&#xA;            var $button = jQuery('<button>');&#xD;&#xA;            $button.text(jQuery(this).text());&#xD;&#xA;            $button.addClass(jQuery(this).data('class'));&#xD;&#xA;            $navigationMenu.append($button);&#xD;&#xA;          });&#xD;&#xA;          if (typeof infowindow === 'undefined') {&#xD;&#xA;            infowindow = new google.maps.InfoWindow({&#xD;&#xA;              height: 380&#xD;&#xA;            });&#xD;&#xA;          }&#xD;&#xA;          var centro = infoCentros[index] //helpful data&#xD;&#xA;          infowindow.setContent(&#xD;&#xA;            '<div class="sescam-info-window">' +&#xD;&#xA;            '<h3>' + centro.nombre + '</h3>' +&#xD;&#xA;            '<p>' + centro.lugar + '</h3>' +&#xD;&#xA;            '<p class="titulo">Coordinador</p>' +&#xD;&#xA;            '<p><strong>' + centro.coordinador.nombre + '</strong></p>' +&#xD;&#xA;            '<p><a href="mailto:' + centro.coordinador.email + '">' + centro.coordinador.email + '</a></p>' +&#xD;&#xA;            '<p class="titulo">Responsable</p>' +&#xD;&#xA;            '<p><strong>' + centro.responsable.nombre + '</strong></p>' +&#xD;&#xA;            '<p><a href="mailto:' + centro.responsable.email + '">' + centro.responsable.email + '</a></p>' +&#xD;&#xA;            '<div class="menu">' + $navigationMenu.html() + '</div>' + '</div>'&#xD;&#xA;          );&#xD;&#xA;          infowindow.open(marker.getMap(), marker);&#xD;&#xA;        }&#xD;&#xA;        var handleMenu = function() {&#xD;&#xA;          jQuery('body').on('click', '.menu button', function() {&#xD;&#xA;            var itemClass = jQuery(this).attr('class');&#xD;&#xA;            jQuery('.listado.' + itemClass).stop(true, true).slideDown().siblings('.listado').stop(true, true).slideUp();&#xD;&#xA;          });&#xD;&#xA;        }&#xD;&#xA;        this.gmap = new google.maps.Map(document.getElementById('mapa'), mapOptions);&#xD;&#xA;        this.gmap.mapTypes.set('map_style', styledMap);&#xD;&#xA;        this.gmap.setMapTypeId('map_style');&#xD;&#xA;        this.mapMarkers = [];&#xD;&#xA;        this.mapInfoWindow = new google.maps.InfoWindow({&#xD;&#xA;          height: 380&#xD;&#xA;        });&#xD;&#xA;        jQuery(window).resize(function() {&#xD;&#xA;          $sescam_ventana.gmap.fitBounds($sescam_ventana.mapBounds);&#xD;&#xA;        });&#xD;&#xA;        for (var i = 0; i < this.mapMarkers.length; i++) {&#xD;&#xA;          // primero eliminamos todos los markers que pudiera haber de una visualización anterior&#xD;&#xA;          this.mapMarkers[i].setMap(null);&#xD;&#xA;        }&#xD;&#xA;        this.mapMarkers.length = 0; // reseteamos el array&#xD;&#xA;        this.mapBounds = new google.maps.LatLngBounds();&#xD;&#xA;        var c = 0; // de inicio no sabemos cuantos elementos tienen realmente latitud y longitud, este contador nos lo chivará&#xD;&#xA;        var latlon; // lo guardamos fuera del each para poder verlo después, si resulta que es el único elemeto a mostrar&#xD;&#xA;        for (var i = 0; i < infoCentros.length; i++) {&#xD;&#xA;          var centro = infoCentros[i];&#xD;&#xA;          var lat = centro.cordenadas.lat;&#xD;&#xA;          var lon = centro.cordenadas.long;&#xD;&#xA;          if (lat && lon) {&#xD;&#xA;            c++;&#xD;&#xA;            latlon = new google.maps.LatLng(lat, lon);&#xD;&#xA;            var moptions = {&#xD;&#xA;              position: latlon,&#xD;&#xA;              map: $sescam_ventana.gmap&#xD;&#xA;            }&#xD;&#xA;            moptions.icon = 'http://icons.iconarchive.com/icons/icons-land/vista-map-markers/256/Map-Marker-Marker-Outside-Pink-icon.png';&#xD;&#xA;            var marker = new google.maps.Marker(moptions);&#xD;&#xA;            $sescam_ventana.mapMarkers.push(marker);&#xD;&#xA;            //google.maps.event.addListener(marker, 'click', handleMarkerClick);&#xD;&#xA;            google.maps.event.addListener(marker, 'click', handleMarkerClick.bind(undefined, marker, i));&#xD;&#xA;            $sescam_ventana.mapBounds.extend(latlon);&#xD;&#xA;          }&#xD;&#xA;        }&#xD;&#xA;        if (c > 1) {&#xD;&#xA;          $sescam_ventana.gmap.fitBounds(this.mapBounds);&#xD;&#xA;        } else {&#xD;&#xA;          // si solo hay uno el fitbounds no hace un zoom ni un centrado correctos&#xD;&#xA;          $sescam_ventana.gmap.setCenter(latlon);&#xD;&#xA;        }&#xD;&#xA;        handleMenu();&#xD;&#xA;      }&#xD;&#xA;    }&#xD;&#xA;    jQuery(function() {&#xD;&#xA;      $sescam_ventana.init();&#xD;&#xA;    });