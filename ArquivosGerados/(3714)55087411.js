    $(document).on("change", "#chatImage", function() {&#xD;&#xA;        var rid = $(this).closest(".chat").data("id");&#xD;&#xA;        var tempSrc = $(this).val();&#xD;&#xA;        /* Make a zip file here */&#xD;&#xA;        var fi = $(this);&#xD;&#xA;        var fileInput = fi;&#xD;&#xA;        var files = [];&#xD;&#xA;        // get all selected file&#xD;&#xA;        $.each(fileInput.files, function(i, file) {&#xD;&#xA;            files.push(file);&#xD;&#xA;        });&#xD;&#xA;        //create a zip object&#xD;&#xA;        var zip = new JSZip();&#xD;&#xA;        //add all files to zip &#xD;&#xA;        function addFileToZip(n) {&#xD;&#xA;            if(n >= files.length) {&#xD;&#xA;                //here generate file to zip on client side&#xD;&#xA;                zip.generateAsync({type:"blob", compression:"default"}).then(function(content){&#xD;&#xA;                    //generated zip content to file type&#xD;&#xA;                    var files = new File([content], "default.zip");&#xD;&#xA;                    console.log(files);&#xD;&#xA;                    var eImgArray = {};&#xD;&#xA;                    $.ajax({&#xD;&#xA;                        url : ajax_object.ajax_url,&#xD;&#xA;                        type : 'post',&#xD;&#xA;                        data : {&#xD;&#xA;                        action: 'get_room_member_keys',&#xD;&#xA;                        rid : rid,&#xD;&#xA;                        },&#xD;&#xA;                        beforeSend: function() {},&#xD;&#xA;                        success: function(html) {&#xD;&#xA;                            var pubKeys = $.parseJSON(html);&#xD;&#xA;                            $.each( pubKeys, function( key, value ) {&#xD;&#xA;                                var imgEncrypt = cryptico.encrypt(files, value);&#xD;&#xA;                                var imgSrc = imgEncrypt.cipher;&#xD;&#xA;                                eImgArray[key] = imgSrc;&#xD;&#xA;                            });&#xD;&#xA;                            var strImgArray = JSON.stringify(eImgArray);&#xD;&#xA;                        },&#xD;&#xA;                    });&#xD;&#xA;                });&#xD;&#xA;                return;&#xD;&#xA;            }&#xD;&#xA;            var file = files[n];                    &#xD;&#xA;            var arrayBuffer;&#xD;&#xA;            var fileReader = new FileReader();&#xD;&#xA;            fileReader.onload = function() {&#xD;&#xA;                arrayBuffer = this.result;&#xD;&#xA;                zip.file(file.name, arrayBuffer);&#xD;&#xA;                addFileToZip(n + 1);&#xD;&#xA;            }&#xD;&#xA;            fileReader.readAsArrayBuffer(file);&#xD;&#xA;        }&#xD;&#xA;        addFileToZip(0);&#xD;&#xA;    });