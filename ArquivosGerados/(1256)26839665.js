    <!DOCTYPE HTML>&#xD;&#xA;        <html lang="en"><head>&#xD;&#xA;            <meta charset="UTF-8" />&#xD;&#xA;            <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>&#xD;&#xA;            <style type="text/css">#canvas { border: 1px solid #000; }</style> &#xD;&#xA;        </head>&#xD;&#xA;        <body>&#xD;&#xA;            <input type=text value="0" id="rvalue" />&#xD;&#xA;            <button id=rotate>Rotate</button><br>&#xD;&#xA;                <canvas id="canvas" width=600 height=400></canvas>&#xD;&#xA;    &#xD;&#xA;                <script>&#xD;&#xA;                    var canvas = document.getElementById("canvas");&#xD;&#xA;                    var ctx = canvas.getContext("2d");&#xD;&#xA;    &#xD;&#xA;                    var canvasOffset = $("#canvas").offset();&#xD;&#xA;                    var offsetX = canvasOffset.left;&#xD;&#xA;                    var offsetY = canvasOffset.top;&#xD;&#xA;    &#xD;&#xA;                    var startX;&#xD;&#xA;                    var startY;&#xD;&#xA;                    var isDown = false;&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;                    var pi2 = Math.PI * 2;&#xD;&#xA;                    var resizerRadius = 6;&#xD;&#xA;                    var rr = resizerRadius * resizerRadius;&#xD;&#xA;                    var draggingResizer = {&#xD;&#xA;                        x: 0,&#xD;&#xA;                        y: 0&#xD;&#xA;                    };&#xD;&#xA;                    var imageX = 0;&#xD;&#xA;                    var imageY = 0;&#xD;&#xA;                    var imageWidth, imageHeight, imageRight, imageBottom;&#xD;&#xA;                    var draggingImage = false;&#xD;&#xA;                    var startX;&#xD;&#xA;                    var startY;&#xD;&#xA;    &#xD;&#xA;                    var img = new Image();&#xD;&#xA;                    img.onload = function() {&#xD;&#xA;                        imageWidth = img.width;&#xD;&#xA;                        imageHeight = img.height;&#xD;&#xA;                        imageRight = imageX + imageWidth;&#xD;&#xA;                        imageBottom = imageY + imageHeight&#xD;&#xA;                        draw();&#xD;&#xA;                    }&#xD;&#xA;                    img.src = "http://www.w3.org/html/logo/downloads/HTML5_Logo_128.png";&#xD;&#xA;    &#xD;&#xA;                    var x = canvas.width / 2, y = canvas.height / 2;&#xD;&#xA;    &#xD;&#xA;                    function draw() {&#xD;&#xA;                        canvas.width = canvas.width;&#xD;&#xA;                        ctx.clearRect(0, 0, canvas.width, canvas.height);&#xD;&#xA;                        ctx.save();&#xD;&#xA;                        &#xD;&#xA;                        //I have problem here!&#xD;&#xA;                        //ctx.translate(x + imageX, y + imageY);&#xD;&#xA;    &#xD;&#xA;                        ctx.rotate($('#rvalue').val() * Math.PI / 180);&#xD;&#xA;                        ctx.drawImage(img, imageX, imageY);&#xD;&#xA;                        ctx.restore();&#xD;&#xA;                        &#xD;&#xA;                        ctx.rect(imageX + 160, imageY + 30, 120, 40);&#xD;&#xA;                        ctx.strokeStyle = "red";&#xD;&#xA;                        ctx.stroke();&#xD;&#xA;                    }&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;                    function hitImage(x, y) {&#xD;&#xA;                        return (x > imageX && x < imageX + imageWidth && y > imageY && y < imageY + imageHeight);&#xD;&#xA;                    }&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;                    function handleMouseDown(e) {&#xD;&#xA;                        startX = parseInt(e.clientX - offsetX);&#xD;&#xA;                        startY = parseInt(e.clientY - offsetY);&#xD;&#xA;                        draggingImage = hitImage(startX, startY);&#xD;&#xA;                    }&#xD;&#xA;    &#xD;&#xA;                    function handleMouseUp(e) {&#xD;&#xA;                        draggingImage = false;&#xD;&#xA;                        draw();&#xD;&#xA;                    }&#xD;&#xA;    &#xD;&#xA;                    function handleMouseOut(e) {&#xD;&#xA;                        handleMouseUp(e);&#xD;&#xA;                    }&#xD;&#xA;    &#xD;&#xA;                    function handleMouseMove(e) {&#xD;&#xA;                        if (draggingImage) {&#xD;&#xA;                            imageClick = false;&#xD;&#xA;                            mouseX = parseInt(e.clientX - offsetX);&#xD;&#xA;                            mouseY = parseInt(e.clientY - offsetY);&#xD;&#xA;                            var dx = mouseX - startX;&#xD;&#xA;                            var dy = mouseY - startY;&#xD;&#xA;                            imageX += dx;&#xD;&#xA;                            imageY += dy;&#xD;&#xA;                            imageRight += dx;&#xD;&#xA;                            imageBottom += dy;&#xD;&#xA;                            startX = mouseX;&#xD;&#xA;                            startY = mouseY;&#xD;&#xA;                            draw();&#xD;&#xA;                        }&#xD;&#xA;                    }&#xD;&#xA;    &#xD;&#xA;    &#xD;&#xA;                    $("#canvas").mousedown(function(e) {&#xD;&#xA;                        handleMouseDown(e);&#xD;&#xA;                    });&#xD;&#xA;                    $("#canvas").mousemove(function(e) {&#xD;&#xA;                        handleMouseMove(e);&#xD;&#xA;                    });&#xD;&#xA;                    $("#canvas").mouseup(function(e) {&#xD;&#xA;                        handleMouseUp(e);&#xD;&#xA;                    });&#xD;&#xA;                    $("#canvas").mouseout(function(e) {&#xD;&#xA;                        handleMouseOut(e);&#xD;&#xA;                    });&#xD;&#xA;                    $("#rotate").click(function(event) {&#xD;&#xA;                        var c = parseInt($('#rvalue').val());&#xD;&#xA;                        $('#rvalue').val(c + 90);&#xD;&#xA;                        draw();&#xD;&#xA;                    });&#xD;&#xA;                </script>&#xD;&#xA;        </body>&#xD;&#xA;    </html>