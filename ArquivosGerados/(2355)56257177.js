(function() {&#xD;&#xA;	var _module = function() {&#xD;&#xA;		const _scope = function() {&#xD;&#xA;			var a = 0, block = 0;&#xD;&#xA;			var suspend = function() {&#xD;&#xA;				var context = {};&#xD;&#xA;				context.a = a;&#xD;&#xA;				context.block = block;&#xD;&#xA;		        context.resume = function() {&#xD;&#xA;		        	_scope.context = context;&#xD;&#xA;		          	return _scope();&#xD;&#xA;		        }&#xD;&#xA;		        _scope.context = context;&#xD;&#xA;		        return context;			&#xD;&#xA;			}&#xD;&#xA;			var awake = function() {&#xD;&#xA;				context = _scope.context;&#xD;&#xA;				delete _scope.context;&#xD;&#xA;				//_scope.context = undefined;&#xD;&#xA;				a = context.a;&#xD;&#xA;				block = context.block;&#xD;&#xA;			}&#xD;&#xA;			if (_scope.context !== undefined) {&#xD;&#xA;				awake();&#xD;&#xA;			}&#xD;&#xA;			while(true) {&#xD;&#xA;				switch(block) {&#xD;&#xA;					case 0:&#xD;&#xA;						block = 1;&#xD;&#xA;						return suspend();&#xD;&#xA;					case 1:&#xD;&#xA;						block = 0;&#xD;&#xA;						if (a++ > 10000) {&#xD;&#xA;							return;&#xD;&#xA;						}&#xD;&#xA;						continue;&#xD;&#xA;				}				&#xD;&#xA;			}&#xD;&#xA;		}&#xD;&#xA;		return _scope();&#xD;&#xA;	}&#xD;&#xA;	var runMod = function() {&#xD;&#xA;		var susp = _module();&#xD;&#xA;		var nSteps = 0;&#xD;&#xA;		while(susp) {&#xD;&#xA;			susp = susp.resume();&#xD;&#xA;			if (!(++nSteps % 1000)) {&#xD;&#xA;				console.log(nSteps, susp);&#xD;&#xA;			}&#xD;&#xA;			if (nSteps > 100000) {&#xD;&#xA;				console.log('aborted')&#xD;&#xA;				break;&#xD;&#xA;			}&#xD;&#xA;		}&#xD;&#xA;		console.log('complete', nSteps);&#xD;&#xA;	}&#xD;&#xA;	runMod();&#xD;&#xA;})()&#xD;&#xA;https://jsfiddle.net/daborkpw/